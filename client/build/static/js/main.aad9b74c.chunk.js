(this.webpackJsonpmajor_project=this.webpackJsonpmajor_project||[]).push([[0],{424:function(e,t,n){},428:function(e,t,n){},469:function(e,t,n){},48:function(e,t){e.exports={JOIN:"join",JOINED:"joined",DISCONNECTED:"disconnected",CODE_CHANGE:"code-change",LANGUAGE_CHANGE:"language-change",UPDATE_LANGUAGE:"language-update",INPUT_CHANGE:"input-change",UPDATE_INPUT:"input-update",LEAVE:"leave",SEND_MESSAGE:"send-message",RECEIVE_MESSAGE:"receive-message",OUTPUT_CHANGE:"output-change",ROOM_MEMBERS:"room-members"}},493:function(e,t,n){},600:function(e,t,n){},602:function(e,t,n){},784:function(e,t,n){},785:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(59),i=n.n(r),s=(n(424),n(38)),o=(n(209),n(23)),u=n(46),d=n(12),l=n(870),j=n(892),b=n(857),O=n(202),h=n(896),p=n(883),x=n(886),f=n(907),g=n(873),m=n(902),v=n(904),y=n(880),C=n(16),k=n(401),w=n(889),T=n(18),_=n(15),E=n(22),S=n(6),I=n(37),D=n(890),R=n(884),N=n(876),A=n(906),P=n(869),H=n(867),M=n(868),G=n(4),F=n(371),U=n(885),L=n(893),W=n(894),V=n(895),B=n(881),J=n(850),z=n(851),K=n(877),q=n(882),X=n(891),Q=n(852),Y=n(853),Z=n(854),$=n(855),ee=n(856),te=n(858),ne="ide/update_langugae",ae="ide/update_code",ce="ide/update_stdin",re="ide/request_execution",ie="ide/update_run",se="ide/code_history_loading",oe="ide/fetch_code_history",ue="ide/set_clients",de="ide/remove_client",le="rtc/get_token_loading",je="rtc/get_token",be="rtc/start_rtc",Oe="rtc/toggle_mic",he="rtc/toggle_camera",pe="rtc/add_user",xe="rtc/remove_user",fe="chat/add_new_message",ge="chat/update_room_users",me="chat/compose_message",ve="chat/fetch_chat_history",ye="chat/history_loading",Ce=(n(428),n.p+"static/media/vscode.a61dc62c.png"),ke=n(1),we=["children","value","index"],Te=function(e){var t=e.children,n=e.value,a=e.index,c=Object(F.a)(e,we);return Object(ke.jsx)("div",Object(_.a)(Object(_.a)({role:"tabpanel",hidden:n!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a)},c),{},{children:n===a&&Object(ke.jsx)(D.a,{sx:{p:1},children:Object(ke.jsx)(O.a,{children:t})})}))},_e=function(e){return Object(G.a)({transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),overflowX:"hidden",width:"calc(".concat(e.spacing(7)," + 1px)")},e.breakpoints.up("sm"),{width:"calc(".concat(e.spacing(8)," + 1px)")})},Ee=Object(S.a)("div")((function(e){var t=e.theme;return Object(_.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:t.spacing(0,1)},t.mixins.toolbar)})),Se=Object(S.a)("div")((function(e){var t=e.theme;return{display:"flex",alignItems:"center",padding:t.spacing(0),zIndex:t.zIndex.Toolbar+1,justifyContent:"flex-start"}})),Ie=Object(S.a)(X.a,{shouldForwardProp:function(e){return"open"!==e}})((function(e){var t=e.theme;e.open;return{zIndex:t.zIndex.drawer+1}})),De=Object(S.a)(R.a,{shouldForwardProp:function(e){return"open"!==e}})((function(e){var t=e.theme;return Object(_.a)(Object(_.a)({flexShrink:0,whiteSpace:"nowrap",boxSizing:"border-box"},_e(t)),{},{"& .MuiDrawer-paper":_e(t)})})),Re=Object(S.a)("main",{shouldForwardProp:function(e){return"open"!==e}})((function(e){var t=e.theme,n=e.open;return Object(_.a)({flexGrow:1,padding:t.spacing(0),transition:t.transitions.create("margin",{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen}),marginRight:-Ae},n&&{transition:t.transitions.create("margin",{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.enteringScreen}),marginRight:0})})),Ne=function(){return Object(ke.jsx)(U.a,{container:!0,spacing:0,direction:"column",alignItems:"center",justifyContent:"center",style:{minHeight:"100vh"},children:Object(ke.jsx)(U.a,{item:!0,xs:3,children:Object(ke.jsx)(L.a,{})})})},Ae=360,Pe=function(){return Object(ke.jsx)(Ie,{position:"fixed",open:!1,children:Object(ke.jsxs)(W.a,{children:[Object(ke.jsx)("img",{width:32,style:{marginRight:"8px"},class:"logo-container",src:Ce,alt:"Logo"}),Object(ke.jsx)(O.a,{variant:"h6",noWrap:!0,component:"div",sx:{display:{xs:"none",sm:"block"}},children:"Code"})]})})},He=function(e){var t=e.tracks,n=e.chatDrawerOpen,a=e.chatDrawerTab,c=e.setTabValue,r=e.setChatDrawerTab,i=e.setChatDrawerOpen,s=Object(E.b)(),d=Object(E.c)((function(e){return e.RTC})).trackState,l=Object(E.c)((function(e){return e.CHAT})).users,j=function(){var e=Object(u.a)(Object(o.a)().mark((function e(n){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("audio"!==n){e.next=6;break}return e.next=3,t[0].setEnabled(!d.audio);case 3:s({type:Oe}),e.next=10;break;case 6:if("video"!==n){e.next=10;break}return e.next=9,t[1].setEnabled(!d.video);case 9:s({type:he});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(ke.jsxs)(De,{variant:"permanent",open:!1,children:[Object(ke.jsx)(Ee,{}),Object(ke.jsxs)(V.a,{children:[Object(ke.jsx)(B.a,{onClick:function(){return c(0)},disablePadding:!0,sx:{display:"block"},children:Object(ke.jsx)(J.a,{sx:{minHeight:48,justifyContent:"center",px:2.5},children:Object(ke.jsx)(z.a,{sx:{minWidth:0,mr:"auto",justifyContent:"center"},children:Object(ke.jsx)(Q.a,{})})})}),Object(ke.jsx)(B.a,{onClick:function(){return c(1)},disablePadding:!0,sx:{display:"block"},children:Object(ke.jsx)(J.a,{sx:{minHeight:48,justifyContent:"center",px:2.5},children:Object(ke.jsx)(z.a,{sx:{minWidth:0,mr:"auto",justifyContent:"center"},children:Object(ke.jsx)(Y.a,{})})})}),Object(ke.jsx)(B.a,{onClick:function(){return c(2)},disablePadding:!0,sx:{display:"block"},children:Object(ke.jsx)(J.a,{sx:{minHeight:48,justifyContent:"center",px:2.5},children:Object(ke.jsx)(z.a,{sx:{minWidth:0,mr:"auto",justifyContent:"center"},children:Object(ke.jsx)(Z.a,{})})})}),Object(ke.jsx)(B.a,{onClick:function(){n?0===a?i(!1):r(0):(r(0),i(!0))},disablePadding:!0,sx:{display:"block"},children:Object(ke.jsx)(J.a,{sx:{minHeight:48,justifyContent:"center",px:2.5},children:Object(ke.jsx)(z.a,{sx:{minWidth:0,mr:"auto",justifyContent:"center"},children:Object(ke.jsx)($.a,{})})})}),Object(ke.jsx)(B.a,{onClick:function(){n?1===a?i(!1):r(1):(r(1),i(!0))},disablePadding:!0,sx:{display:"block"},children:Object(ke.jsx)(J.a,{sx:{minHeight:48,justifyContent:"center",px:2.5},children:Object(ke.jsx)(z.a,{sx:{minWidth:0,mr:"auto",justifyContent:"center"},children:Object(ke.jsx)(K.a,{badgeContent:l.length,color:"primary",children:Object(ke.jsx)(ee.a,{})})})})}),Object(ke.jsxs)(b.a,{sx:{bottom:0,position:"fixed",overflow:"hidden"},direction:"column",spacing:0,justifyContent:"center",alignItems:"center",children:[Object(ke.jsx)(te.a,{}),Object(ke.jsx)(q.a,{checked:d.audio,onChange:function(){return j("audio")},name:"audio"})]}),Object(ke.jsxs)(b.a,{sx:{bottom:72,position:"fixed",overflow:"hidden"},direction:"column",spacing:0,justifyContent:"center",alignItems:"center",children:[Object(ke.jsx)(Z.a,{}),Object(ke.jsx)(q.a,{checked:d.video,onChange:function(){return j("video")},name:"video"})]})]})]})},Me=n(111),Ge=n(48),Fe=n.n(Ge),Ue=n(374),Le=(n(451),n(452),n(281),n(453),n(454),n(455),n(456),n(282),n(460),n(461),n(462),n(464),n(465),n(468),n(469),function(e){var t=e.socketRef,n=Object(E.c)((function(e){return e.IDE})),a=Object(E.c)((function(e){return e.RTC})).roomId,c=Object(E.b)();return Object(ke.jsx)(Ue.Controlled,{value:n.code,options:{mode:{name:function(){switch(n.language){case"cpp":case"c":case"java":return"clike";case"go":return"go";case"swift":return"swift";case"php":return"php";default:return"javascript"}}()},theme:"dracula",keyMap:"sublime",showHint:!0,autoCloseTags:!0,autoCloseBrackets:!0,lineNumbers:!0,lineWrapping:!0,indentWithTabs:!0},onBeforeChange:function(e,n,r){console.log("before",n.origin,r),["+input","+delete","cut","paste","undo","redo"].includes(n.origin)&&(c({type:ae,payload:r}),t.current.emit(Fe.a.CODE_CHANGE,{roomId:a,code:r}))},onChange:function(e,t,n){}})}),We=n(269),Ve=function(){return Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_URL},Be=Ve(),Je=function(){var e=Object(u.a)(Object(o.a)().mark((function e(){var t;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={"force new connection":!0,reconnectionAttempt:"Infinity",timeout:1e4,transports:["websocket"]},console.log("initSocket backendUrl",Be),e.abrupt("return",Object(We.a)(Be,t));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ze=n(402),Ke=n(793),qe=n(900),Xe=n(860),Qe=n(861),Ye=n(376),Ze=n.n(Ye),$e=Ve(),et=Ze.a.create({baseURL:$e}),tt=n(874),nt=n(899),at=(n(493),function(e){var t=e.socketRef,n=Object(E.c)((function(e){return e.IDE})),a=Object(E.c)((function(e){return e.RTC})).roomId,c=Object(E.b)(),r=function(e){var t,a,r;c((t=n.code,a=n.language,r=n.stdin,function(){var e=Object(u.a)(Object(o.a)().mark((function e(n){var c;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("executeCode"),n({type:re}),c={data:[]},e.prev=3,e.next=6,et.post("/code/execute",{code:t,language:a,stdin:r});case 6:return c=e.sent,e.next=9,n({type:ie,payload:c.data});case 9:e.next=15;break;case 11:e.prev=11,e.t0=e.catch(3),console.log("executeCode error",e.t0),s.b.error(e.t0.message,{position:s.b.POSITION.BOTTOM_LEFT});case 15:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t){return e.apply(this,arguments)}}()))},i={color:"white",width:"100%",background:"#0000002e",border:"none",borderRadius:"4px",boxShadow:"none",outline:"none",padding:"10px"};return Object(ke.jsx)(ke.Fragment,{children:Object(ke.jsxs)(j.a,{sx:{height:"100%",overflow:"hidden"},children:[Object(ke.jsxs)(ze.a,{className:"split",sizes:[70,30],children:[Object(ke.jsx)(D.a,{children:Object(ke.jsx)(Le,{socketRef:t})}),Object(ke.jsxs)(b.a,{sx:{p:2},spacing:2,children:[Object(ke.jsxs)(h.a,{variant:"standard",children:[Object(ke.jsx)(p.a,{id:"lang-select-label",children:"Language"}),Object(ke.jsxs)(tt.a,{variant:"filled",labelId:"lang-select-label",id:"lang-select",value:n.language,label:"Language",onChange:function(e){var n=e.target.value;c({type:ne,payload:n}),t.current.emit(Fe.a.LANGUAGE_CHANGE,{roomId:a,language:n})},children:[Object(ke.jsx)(nt.a,{value:"c++",children:"C++"}),Object(ke.jsx)(nt.a,{value:"java",children:"Java"}),Object(ke.jsx)(nt.a,{value:"python",children:"Python"}),Object(ke.jsx)(nt.a,{value:"javascript",children:"JavaScript"}),Object(ke.jsx)(nt.a,{value:"go",children:"Go"}),Object(ke.jsx)(nt.a,{value:"c",children:"C"}),Object(ke.jsx)(nt.a,{value:"php",children:"PHP"})]})]}),Object(ke.jsxs)(h.a,{variant:"standard",children:[Object(ke.jsx)(O.a,{variant:"overline",display:"block",gutterBottom:!0,children:"Input"}),Object(ke.jsx)(Ke.a,{"data-gramm":"false",style:i,minRows:13,maxRows:15,value:n.stdin,onChange:function(e){return function(e){var n=e.target.value;c({type:ce,payload:n}),t.current.emit(Fe.a.INPUT_CHANGE,{roomId:a,input:n})}(e)}})]}),Object(ke.jsxs)(h.a,{variant:"standard",children:[Object(ke.jsx)(O.a,{variant:"overline",display:"block",gutterBottom:!0,children:"Output"}),Object(ke.jsx)(Ke.a,{onClick:function(){s.b.info("Output is read only",{position:s.b.POSITION.BOTTOM_RIGHT,autoClose:1e3})},style:i,readOnly:!0,minRows:13,maxRows:15,value:n.run.stderr+(n.run.signal?n.run.signal:"")+n.run.stdout})]})]})]}),Object(ke.jsx)(qe.a,{disabled:n.is_executing,style:{margin:0,top:"auto",right:20,bottom:20,left:"auto",position:"fixed",zIndex:12},onClick:function(){r()},children:n.is_executing?Object(ke.jsx)(Xe.a,{}):Object(ke.jsx)(Qe.a,{})})]})})}),ct=n(378),rt=n(399),it=n(887),st=n(901),ot=n(878),ut=n(862),dt=n(863),lt=n(864),jt=n(865);n(600);function bt(e){var t=e.socketRef,n=e.canvasRef,c=e.paths,r=e.setPaths,i=Object(E.c)((function(e){return e.RTC})),s=i.uid,o=i.roomId,u=Object(a.useState)("#000000"),l=Object(d.a)(u,2),j=l[0],O=l[1],h=Object(a.useState)(4),p=Object(d.a)(h,2),x=p[0],f=p[1],v=Object(a.useState)("draw"),y=Object(d.a)(v,2),C=y[0],k=y[1],w=Object(a.useState)({className:"react-sketch-canvas",width:"100%",height:"75vh",canvasColor:"#FFFFFF",style:{border:"1px solid #CCC",borderRadius:"0.25rem"},allowOnlyPointerType:"all"}),T=Object(d.a)(w,2),S=T[0],I=(T[1],Object(a.useState)({stroke:null,isEraser:null})),D=Object(d.a)(I,2),R=(D[0],D[1]);Object(a.useEffect)((function(){t.current.emit("join-drawing",{name:s,drawingId:o,color:"#000000"})}),[]),Object(a.useEffect)((function(){var e,t=null===(e=n.current)||void 0===e?void 0:e.eraseMode;t("draw"!==C)}),[C,n]);return Object(ke.jsxs)(ke.Fragment,{children:[Object(ke.jsx)(U.a,{container:!0,spacing:1,children:Object(ke.jsx)(U.a,{item:!0,xs:12,children:Object(ke.jsx)(ct.a,Object(_.a)({defaultValue:c,ref:n,onChange:function(e){var n;e.length&&(null===(n=t.current)||void 0===n||n.emit("update-canvas",{drawingId:o,msg:e}));r(e)},onStroke:function(e,n){R({stroke:e,isEraser:n}),t.current.emit("input-canvas",{drawingId:o,msg:e})},strokeColor:j,strokeWidth:x,eraserWidth:x},S))})}),Object(ke.jsxs)(U.a,{container:!0,p:2,children:[Object(ke.jsx)(U.a,{item:!0,xs:2,children:Object(ke.jsxs)(it.a,{color:"primary",value:C,exclusive:!0,onChange:function(e,t){k(t)},"aria-label":"Mode",children:[Object(ke.jsxs)(st.a,{value:"draw",children:[Object(ke.jsx)(ut.a,{}),"Draw"]}),Object(ke.jsxs)(st.a,{value:"erase",children:[Object(ke.jsx)(dt.a,{}),"Erase"]})]})}),Object(ke.jsx)(U.a,{item:!0,xs:3,children:Object(ke.jsxs)(b.a,{direction:"row",spacing:1,children:[Object(ke.jsx)(g.a,{title:"Stroke size",children:Object(ke.jsx)(m.a,{children:Object(ke.jsx)(lt.a,{})})}),Object(ke.jsx)(ot.a,{size:"small",defaultValue:x,onChange:function(e){return f(e.target.value)},min:1,max:100,valueLabelDisplay:"auto"})]})}),Object(ke.jsx)(U.a,{item:!0,xs:2,children:Object(ke.jsx)(b.a,{direction:"row",spacing:2,children:Object(ke.jsx)(g.a,{title:"Clear All",children:Object(ke.jsx)(m.a,{onClick:function(){return function(){var e,a,c,r=null===(e=n.current)||void 0===e?void 0:e.clearCanvas;r&&(null===(a=t.current)||void 0===a||a.emit("input-control",{type:"clear",drawingId:o}),null===(c=t.current)||void 0===c||c.emit("update-canvas",{drawingId:o,msg:[]}),r())}()},children:Object(ke.jsx)(jt.a,{})})})})}),Object(ke.jsx)(U.a,{item:!0,xs:3,children:Object(ke.jsx)(rt.a,{colors:["#f44336","#ff9800","#9c27b0","#3f51b5","#009688","#000000"],onChange:function(e,t){O(e.hex)}})})]})]})}n(601),n(602);var Ot=function(e){var t=e.tracks,n=Object(a.useState)(!1),c=Object(d.a)(n,2),r=(c[0],c[1],Object(E.c)((function(e){return e.RTC}))),i=r.start,s=r.users;return Object(ke.jsx)(ke.Fragment,{children:i?Object(ke.jsx)(D.a,{sx:{display:"flex"},children:Object(ke.jsx)(ke.Fragment,{children:Object(ke.jsxs)("div",{id:"videos",children:[Object(ke.jsx)(Me.AgoraVideoPlayer,{style:{height:"95%",width:"95%"},className:"vid",videoTrack:t[1]}),s.length>0&&s.map((function(e){return e.videoTrack?Object(ke.jsx)(Me.AgoraVideoPlayer,{style:{height:"95%",width:"95%"},className:"vid",videoTrack:e.videoTrack},e.uid):null}))]})})}):Object(ke.jsx)(Ne,{})})},ht=n(903),pt=n(400);n(784);var xt=function(e){var t=e.sendMessage,n=Object(E.b)(),a=Object(E.c)((function(e){return e.RTC})).username,c=Object(E.c)((function(e){return e.CHAT})),r=c.message,i=c.messages;return Object(ke.jsx)(D.a,{children:Object(ke.jsx)(ke.Fragment,{children:Object(ke.jsxs)("div",{className:"chat-window",children:[Object(ke.jsx)("div",{className:"chat-body",children:Object(ke.jsx)(pt.a,{className:"message-container",children:i&&i.length>0&&i.map((function(e){return Object(ke.jsx)("div",{className:"message",id:a===e.user?"other":"you",children:Object(ke.jsxs)("div",{children:[Object(ke.jsx)("div",{className:"message-content",children:Object(ke.jsx)("p",{children:e.text})}),Object(ke.jsx)("div",{className:"message-meta",children:Object(ke.jsx)("p",{id:"author",children:e.user})})]})})}))})}),Object(ke.jsx)(D.a,{className:"chat-footer",sx:{width:"340px",position:"fixed",bottom:50},children:Object(ke.jsx)(ht.a,{variant:"outlined",fullWidth:!0,value:r,onKeyPress:function(e){return"Enter"===e.key?t(e):null},onChange:function(e){n({type:me,payload:e.target.value})},placeholder:"Message"})})]})})})},ft=n(905),gt=n(888),mt=n(866);function vt(){var e=Object(E.c)((function(e){return e.CHAT})).users,t=function(e){return e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))};function n(e){var t,n=0;for(t=0;t<e.length;t+=1)n=e.charCodeAt(t)+((n<<5)-n);var a="#";for(t=0;t<3;t+=1){a+="00".concat((n>>8*t&255).toString(16)).slice(-2)}return a}return Object(ke.jsx)(ke.Fragment,{children:Object(ke.jsxs)(V.a,{sx:{width:"100%",bgcolor:"background.paper"},children:[Object(ke.jsx)(B.a,{alignItems:"flex-start",children:Object(ke.jsxs)(O.a,{variant:"h6",component:"div",children:[e.length+" Participant".concat(e.length>1?"s":"")," "]})},"count"),e.map((function(e,a){return Object(ke.jsxs)(B.a,{alignItems:"flex-start",children:[Object(ke.jsx)(ft.a,{children:Object(ke.jsx)(gt.a,Object(_.a)({alt:e.user},(c=e.user,{sx:{bgcolor:n(c),color:"#ffffff"},children:"".concat(t(c[0]))})))}),Object(ke.jsx)(mt.a,{sx:{pt:1.2},primary:t(e.user),secondary:null})]},a);var c}))]})})}var yt=function(e){var t=e.socketRef,n=e.canvasRef,a=e.paths,c=e.setPaths,r=e.tracks,i=e.tabValue,s=e.setTabValue,o=e.chatDrawerOpen,u=e.setChatDrawerOpen,d=e.chatDrawerTab,l=e.setChatDrawerTab,b=e.sendMessage,O=Object(I.a)();return Object(ke.jsx)(j.a,{children:Object(ke.jsxs)(D.a,{sx:{display:"flex"},children:[Object(ke.jsx)(Pe,{}),Object(ke.jsx)(He,{tracks:r,chatDrawerOpen:o,chatDrawerTab:d,setTabValue:s,setChatDrawerTab:l,setChatDrawerOpen:u}),Object(ke.jsxs)(Re,{open:o,sx:{flexGrow:1},children:[Object(ke.jsx)(Te,{value:i,index:0,children:Object(ke.jsx)(at,{socketRef:t})}),Object(ke.jsx)(Te,{value:i,index:1,children:Object(ke.jsx)(bt,{paths:a,setPaths:c,socketRef:t,canvasRef:n})}),Object(ke.jsx)(Te,{value:i,index:2,children:Object(ke.jsx)(Ot,{tracks:r})})]}),Object(ke.jsxs)(R.a,{style:{visibility:o?"visible":"hidden"},sx:{width:Ae,flexShrink:0,"& .MuiDrawer-paper":{width:Ae}},variant:"persistent",anchor:"right",open:o,children:[Object(ke.jsxs)(Se,{children:[Object(ke.jsx)(m.a,{onClick:function(){return u(!1)},children:"rtl"===O.direction?Object(ke.jsx)(H.a,{}):Object(ke.jsx)(M.a,{})}),Object(ke.jsxs)(N.a,{value:d,onChange:function(e,t){l(t)},"aria-label":"basic tabs example",children:[Object(ke.jsx)(A.a,{label:"Chat"}),Object(ke.jsx)(A.a,{label:"Users"})]})]}),Object(ke.jsx)(P.a,{}),Object(ke.jsxs)(ke.Fragment,{children:[Object(ke.jsx)(Te,{value:d,index:0,children:Object(ke.jsx)(xt,{sendMessage:b})}),Object(ke.jsx)(Te,{value:d,index:1,children:Object(ke.jsx)(vt,{})})]})]})]})})},Ct=Object(S.a)("main",{shouldForwardProp:function(e){return"open"!==e}})((function(e){var t=e.theme,n=e.open;return Object(_.a)({flexGrow:1,padding:t.spacing(0),transition:t.transitions.create("margin",{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen}),marginRight:-320},n&&{transition:t.transitions.create("margin",{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.enteringScreen}),marginRight:0})})),kt=Object(S.a)("div")((function(e){var t=e.theme;return Object(_.a)(Object(_.a)({display:"flex",alignItems:"center",padding:t.spacing(0)},t.mixins.toolbar),{},{justifyContent:"flex-start"})}));function wt(e){var t=e.useClient,n=e.useMicrophoneAndCameraTracks,r=Object(E.b)(),i=Object(I.a)(),l=c.a.useState(!1),j=Object(d.a)(l,2),b=j[0],O=j[1],h=c.a.useState(1),p=Object(d.a)(h,2),x=p[0],f=p[1],g=Object(a.useState)(0),v=Object(d.a)(g,2),y=v[0],C=v[1],k=Object(a.useState)(!1),w=Object(d.a)(k,2),_=w[0],S=w[1],G=c.a.useState(1),F=Object(d.a)(G,2),U=F[0],L=F[1],W=Object(a.useRef)(null),V=Object(E.c)((function(e){return e.RTC})),B=V.appId,J=V.username,z=V.rtcToken,K=V.uid,q=V.roomId,X=Object(E.c)((function(e){return e.CHAT})).message,Q=(Object(E.c)((function(e){return e.IDE})),t()),Y=n(),Z=Y.ready,$=Y.tracks,ee=Object(a.useState)([]),te=Object(d.a)(ee,2),re=te[0],ie=te[1],se=Object(a.useRef)();Object(a.useEffect)((function(){var e=function(){var e=Object(u.a)(Object(o.a)().mark((function e(t){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Q.on("user-published",function(){var e=Object(u.a)(Object(o.a)().mark((function e(t,n){var a;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q.subscribe(t,n);case 2:console.log("subscribe success"),"video"===n&&r({type:pe,payload:t}),"audio"===n&&(null===(a=t.audioTrack)||void 0===a||a.play());case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),Q.on("user-unpublished",(function(e,t){var n;(console.log("unpublished",e,t),"audio"===t)&&(null===(n=e.audioTrack)||void 0===n||n.stop());"video"===t&&r({type:xe,payload:e.uid})})),Q.on("user-left",(function(e){console.log("leaving",e),r({type:xe,payload:e.uid})})),e.next=5,Q.join(B,t,z,K);case 5:if(!$){e.next=13;break}return e.next=8,Q.publish([$[0],$[1]]);case 8:return r({type:be}),e.next=11,$[0].setEnabled(!1);case 11:return e.next=13,$[1].setEnabled(!1);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Z&&$&&e(q)}),[q,Q,Z,$]);function oe(e){console.log("socket error",e),s.b.error("Socket connection failed, try again later.")}Object(a.useEffect)((function(){var e=function(){var e=Object(u.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Je();case 2:W.current=e.sent,W.current.on("connect_error",(function(e){return oe(e)})),W.current.on("connect_failed",(function(e){return oe(e)})),W.current.on(Fe.a.RECEIVE_MESSAGE,(function(e){r({type:fe,payload:e})})),W.current.on(Fe.a.ROOM_MEMBERS,(function(e){r({type:ge,payload:e})})),W.current.emit("join",{user:J,room:q},(function(e){e&&console.log("err",e)})),W.current.emit(Fe.a.JOIN,{roomId:q,username:K}),W.current.on(Fe.a.CODE_CHANGE,(function(e){var t=e.code;null!==t&&r({type:ae,payload:t})})),W.current.on(Fe.a.UPDATE_LANGUAGE,(function(e){var t=e.language;r({type:ne,payload:t}),s.b.info("Language changed to ".concat(t),{position:s.b.POSITION.BOTTOM_RIGHT,autoClose:3e3})})),W.current.on(Fe.a.UPDATE_INPUT,(function(e){var t=e.input;r({type:ce,payload:t})})),W.current.on(Fe.a.JOINED,(function(e){var t=e.clients;e.username,e.socketId;r({type:ue,payload:t})})),W.current.on(Fe.a.DISCONNECTED,(function(e){var t=e.socketId;e.username;r({type:de,payload:t})})),W.current.emit("join-drawing",{name:K,drawingId:q,color:"#000000"}),W.current.on("update-canvas",(function(e){var t,n=[e].concat(Object(T.a)(re));null===(t=se.current)||void 0===t||t.loadPaths(n),ie(n)})),W.current.on("joined-drawing",(function(e){var t,n=e.drawing;e.users;null===(t=se.current)||void 0===t||t.loadPaths(n),ie(n)})),W.current.on("update-control",(function(e){var t,n,a,c;switch(e){case"undo":var r=null===(t=se.current)||void 0===t?void 0:t.undo;r&&r();break;case"redo":var i=null===(n=se.current)||void 0===n?void 0:n.redo;i&&i();break;case"clear":var s=null===(a=se.current)||void 0===a?void 0:a.clearCanvas;s&&s();break;case"reset":var o=null===(c=se.current)||void 0===c?void 0:c.resetCanvas;o&&o()}}));case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return e(),function(){W.current.disconnect(),W.current.off(Fe.a.JOINED),W.current.off(Fe.a.DISCONNECTED)}}),[]);return Object(ke.jsxs)(D.a,{sx:{display:"flex",background:"#1e1e1e"},children:[Object(ke.jsxs)(Ct,{open:b,children:[Object(ke.jsx)(kt,{}),Object(ke.jsx)(yt,{socketRef:W,canvasRef:se,paths:re,setPaths:ie,tracks:$,tabValue:y,setTabValue:C,chatDrawerOpen:_,setChatDrawerOpen:S,chatDrawerTab:U,setChatDrawerTab:L,sendMessage:function(e){e.preventDefault(),0!==X.length&&W.current.emit(Fe.a.SEND_MESSAGE,X,(function(){r({type:me,payload:""})}))}})]}),Object(ke.jsxs)(R.a,{style:{visibility:b?"visible":"hidden"},sx:{pt:2,width:320,flexShrink:0,"& .MuiDrawer-paper":{width:320}},variant:"persistent",anchor:"right",open:b,children:[Object(ke.jsxs)(kt,{children:[Object(ke.jsx)(m.a,{onClick:function(){O(!1)},children:"rtl"===i.direction?Object(ke.jsx)(H.a,{}):Object(ke.jsx)(M.a,{})}),Object(ke.jsxs)(N.a,{value:x,onChange:function(e,t){f(t)},"aria-label":"drawer tabs",children:[Object(ke.jsx)(A.a,{label:"Chat"}),Object(ke.jsx)(A.a,{label:"Users"})]})]}),Object(ke.jsx)(P.a,{})]}),Object(ke.jsx)(s.a,{theme:"dark"})]})}var Tt=n(871),_t=n(872),Et=n(396),St=n(879),It=Object(k.a)({palette:{mode:"dark"}}),Dt=Object(Me.createClient)({mode:"rtc",codec:"vp8"}),Rt=Object(Me.createMicrophoneAndCameraTracks)(),Nt=function(){var e=Object(E.b)(),t=Object(E.c)((function(e){return e.RTC})),n=t.rtcToken,c=t.loading,r=Object(a.useState)(""),i=Object(d.a)(r,2),k=i[0],T=i[1],_=Object(a.useState)(""),S=Object(d.a)(_,2),I=S[0],D=S[1],R=Object(a.useState)(!1),N=Object(d.a)(R,2),A=N[0],P=N[1],H=Object(a.useState)(!1),M=Object(d.a)(H,2),G=M[0],F=M[1],U=Object(a.useState)(""),L=Object(d.a)(U,2),W=L[0],V=L[1],B=Object(C.h)().roomId;Object(a.useEffect)((function(){J(),D(Object(St.a)())}),[]),Object(a.useEffect)((function(){A&&(0===k.length?(F(!0),V("Name is required")):(F(!1),V("")))}),[A,k]);var J=function(){var e=Object(u.a)(Object(o.a)().mark((function e(){var t;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Et.a)();case 2:t=e.sent,T(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(ke.jsxs)(w.a,{theme:It,children:[Object(ke.jsx)(l.a,{}),Object(ke.jsx)(ke.Fragment,{children:n.length?Object(ke.jsx)(ke.Fragment,{children:Object(ke.jsx)(wt,{useClient:Dt,useMicrophoneAndCameraTracks:Rt})}):Object(ke.jsxs)(ke.Fragment,{children:[Object(ke.jsx)(j.a,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",boxShadow:24,minWidth:"40%",p:3},children:Object(ke.jsxs)(b.a,{spacing:2,justifyItems:"center",children:[Object(ke.jsx)(O.a,{variant:"overline",component:"h2",children:"What's your name?"}),Object(ke.jsxs)(h.a,{variant:"outlined",children:[Object(ke.jsx)(p.a,{htmlFor:"name-join-room",children:"Name"}),Object(ke.jsx)(x.a,{value:k,onChange:function(e){T(e.target.value)},error:G,id:"name",label:"Name",inputProps:{maxLength:28},endAdornment:Object(ke.jsx)(f.a,{position:"end",children:Object(ke.jsx)(g.a,{title:"Generate Username",children:Object(ke.jsx)(m.a,{"aria-label":"generate name",onClick:J,edge:"end",children:Object(ke.jsx)(Tt.a,{})})})})}),Object(ke.jsx)(v.a,{error:G,id:"name-error",children:W})]}),Object(ke.jsx)(y.a,{onClick:function(){P(!0),!G&&k.length&&e(function(e,t,n){return function(){var a=Object(u.a)(Object(o.a)().mark((function a(c){var r,i;return Object(o.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,c({type:le}),a.next=4,et.get("/call/rtc/".concat(e,"/publisher/uid/").concat(encodeURIComponent(n)));case 4:r=a.sent,i=r.data,console.log("data",i),c({type:je,payload:{rtcToken:i.rtcToken,roomId:e,uid:n,username:t}}),c({type:ae,payload:i.roomData.code}),c({type:ce,payload:i.roomData.stdin}),c({type:ne,payload:i.roomData.language}),c({type:ve,payload:i.roomData.chat}),a.next=18;break;case 14:a.prev=14,a.t0=a.catch(0),console.log("error",a.t0),s.b.error(a.t0.message,{position:s.b.POSITION.BOTTOM_LEFT});case 18:case"end":return a.stop()}}),a,null,[[0,14]])})));return function(e){return a.apply(this,arguments)}}()}(B,k,I))},endIcon:Object(ke.jsx)(_t.a,{}),loading:c,loadingPosition:"end",variant:"contained",children:"Join"})]})}),Object(ke.jsx)(s.a,{theme:"dark"})]})})]})};function At(){return Object(a.useEffect)((function(){})),Object(ke.jsxs)(C.d,{children:[Object(ke.jsx)(C.b,{path:"/",exact:!0,element:Object(ke.jsx)(C.a,{to:"/".concat(Object(St.a)()),replace:!0})}),Object(ke.jsx)(C.b,{path:"/:roomId",element:Object(ke.jsx)(Nt,{})})]})}var Pt=n(129),Ht=n(397),Mt=(n(367),{languages_loading:!1,languages:[],language:"python",code:"",stdin:"",is_executing:!1,clients:[],run:{stdout:"",stderr:"",code:0,signal:null,output:""}}),Gt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ae:return Object(_.a)(Object(_.a)({},e),{},{code:t.payload});case ne:return Object(_.a)(Object(_.a)({},e),{},{language:t.payload});case ce:return Object(_.a)(Object(_.a)({},e),{},{stdin:t.payload});case ie:return Object(_.a)(Object(_.a)({},e),{},{is_executing:!1,run:t.payload});case re:return Object(_.a)(Object(_.a)({},e),{},{is_executing:!0});case ue:return Object(_.a)(Object(_.a)({},e),{},{clients:t.payload});case de:return Object(_.a)(Object(_.a)({},e),{},{clients:e.clients.filter((function(e){return e.socketId!==t.payload}))});case se:return Object(_.a)(Object(_.a)({},e),{},{history_loading:!0});case oe:return Object(_.a)(Object(_.a)({},e),{},{history_loading:!1,code:t.payload.code,language:t.payload.language});default:return e}},Ft={loading:!1,rtcToken:"",uid:"",username:"",roomId:"",start:!1,appId:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_AGORA_ID,users:[],trackState:{video:!1,audio:!1}},Ut=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ft,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case le:return Object(_.a)(Object(_.a)({},e),{},{loading:!0});case pe:return Object(_.a)(Object(_.a)({},e),{},{users:[].concat(Object(T.a)(e.users),[t.payload])});case xe:return Object(_.a)(Object(_.a)({},e),{},{users:e.users.filter((function(e){return e.uid!==t.payload}))});case be:return Object(_.a)(Object(_.a)({},e),{},{start:!0});case he:return Object(_.a)(Object(_.a)({},e),{},{trackState:Object(_.a)(Object(_.a)({},e.trackState),{},{video:!e.trackState.video})});case Oe:return Object(_.a)(Object(_.a)({},e),{},{trackState:Object(_.a)(Object(_.a)({},e.trackState),{},{audio:!e.trackState.audio})});case je:return Object(_.a)(Object(_.a)({},e),{},{loading:!1,rtcToken:t.payload.rtcToken,uid:t.payload.uid,roomId:t.payload.roomId,username:t.payload.username});default:return e}},Lt={chat_history_loading:!1,messages:[],message:"",users:[]},Wt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ye:return Object(_.a)(Object(_.a)({},e),{},{chat_history_loading:!0});case ve:return Object(_.a)(Object(_.a)({},e),{},{chat_history_loading:!1,messages:t.payload});case fe:return Object(_.a)(Object(_.a)({},e),{},{messages:[].concat(Object(T.a)(e.messages),[t.payload])});case ge:return Object(_.a)(Object(_.a)({},e),{},{users:t.payload});case me:return Object(_.a)(Object(_.a)({},e),{},{message:t.payload});default:return e}},Vt=Object(Pt.combineReducers)({IDE:Gt,RTC:Ut,CHAT:Wt}),Bt=[n(398).a],Jt=Object(Pt.createStore)(Vt,{},Object(Ht.composeWithDevTools)(Pt.applyMiddleware.apply(void 0,Bt))),zt=n(123);i.a.render(Object(ke.jsx)(zt.a,{children:Object(ke.jsx)(E.a,{store:Jt,children:Object(ke.jsx)(At,{})})}),document.getElementById("root"))}},[[785,1,2]]]);
//# sourceMappingURL=main.aad9b74c.chunk.js.map